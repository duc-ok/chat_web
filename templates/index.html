<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Chatbot Python</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        #chatbox {
            width: 100%;
            height: 300px;
            border: 1px solid #ccc;
            padding: 10px;
            overflow-y: scroll;
            margin-bottom: 20px;
        }
        #chatbox p {
            margin: 5px 0;
        }
        input, textarea, button {
            margin: 5px 0;
            padding: 5px;
        }
    </style>
</head>
<body>

<h1>ðŸ’¬ Chat vá»›i Python Bot</h1>

<div id="chatbox"></div>

<input type="text" id="question" placeholder="Nháº­p cÃ¢u há»i cá»§a báº¡n" style="width: 60%;">
<button onclick="guiCauHoi()">Gá»­i</button>

<hr>

<h2>ðŸ§  ThÃªm kiáº¿n thá»©c má»›i</h2>
<input type="text" id="y_dinh" placeholder="Ã Ä‘á»‹nh (vd: thá»i tiáº¿t)">
<br>
<textarea id="patterns" placeholder="Máº«u cÃ¢u (má»—i máº«u 1 dÃ²ng)" rows="4" cols="50"></textarea>
<br>
<textarea id="responses" placeholder="CÃ¢u tráº£ lá»i (má»—i cÃ¢u 1 dÃ²ng)" rows="4" cols="50"></textarea>
<br>
<button onclick="themKienThuc()">ThÃªm kiáº¿n thá»©c</button>

<p id="status"></p>

<script>
function themKienThuc() {
    const y_dinh = document.getElementById("y_dinh").value.trim();
    const patterns = document.getElementById("patterns").value.trim().split("\n");
    const responses = document.getElementById("responses").value.trim().split("\n");

    if (!y_dinh || patterns.length === 0 || responses.length === 0) {
        alert("Vui lÃ²ng nháº­p Ä‘áº§y Ä‘á»§ thÃ´ng tin.");
        return;
    }

    fetch("/them_kienthuc", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
            y_dinh: y_dinh,
            patterns: patterns,
            responses: responses
        })
    })
    .then(res => res.json())
    .then(data => {
        document.getElementById("status").innerText = data.message;
    })
    .catch(err => {
        document.getElementById("status").innerText = "âŒ Lá»—i khi thÃªm kiáº¿n thá»©c.";
    });
}

function guiCauHoi() {
    const cauHoi = document.getElementById("question").value;
    if (!cauHoi.trim()) return;

    fetch("/hoi", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ cau_hoi: cauHoi })
    })
    .then(res => res.json())
    .then(data => {
        const chatbox = document.getElementById("chatbox");
        chatbox.innerHTML += `<p><strong>Báº¡n:</strong> ${cauHoi}</p>`;
        chatbox.innerHTML += `<p><strong>Bot:</strong> ${data.tra_loi}</p>`;
        chatbox.scrollTop = chatbox.scrollHeight;
        document.getElementById("question").value = "";
    });
}
</script>

</body>
</html>
